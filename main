import tkinter as tk
from tkinter import filedialog
import pandas as pd
import xlrd

start = 'Plese select option: 1. Enter financial data manually. 2. Upload excel document. 3'
print(start)
choice = int(input("Enter selection"))




if choice == 1:  #manual fin data input
    # input
    # balance sheet info
    print('Please enter B/S data')
    cur_a = float(input("Enter current assets"))
    inv = float(input('Enter inventory'))
    long_a = float(input('Enter long term assets'))
    cur_L = float(input('Enter current liabilities'))
    long_L = float(input('Enter long term liabilities'))
    equ = float(input('Enter equity'))
    # profit/loss info
    print("Please enter P/L data")
    rev = float(input("Please enter revenue"))
    cogs = float(input('Please enter COGS'))
    opx = float(input("Please enter operating expenses"))
    # cash flow info
    print("Please enter cash flow data")
    opr = float(input("Please enter cash flow from operations"))
    inv = float(input("Please enter cash flow from investing"))
    fin = float(input('Please enter cash flow from financing'))
   
   # ratios
    # liquidity
    cur_ratio = cur_a / cur_L
    acid_ratio = (cur_a - inv) / cur_L
    operating_cash_flow_ratio = opr / cur_L

    # debt
    debt_ratio = (cur_a + long_a) / (cur_L - long_L)
    debt_equity = (cur_a + long_a) / equ

    # efficiency
    ass_turnover_ratio = rev / (cur_a + long_a)

    # profits
    gross_profit = ((rev - cogs) / rev) * 100
    op_marg_ratio = ((rev - cogs - opx) / rev) * 100

    # liquidity
    print('Current ratio: ', cur_ratio)
    if cur_ratio < 1:
        print(
            "Possible liquidity problems regarding short-term obligations. Please note that low current ratio is normal in retail sector. ")
    elif cur_ratio == 1 or cur_ratio > 1:
        print("Normal liquiduty")

    print('Quick ratio: ', acid_ratio)
    if acid_ratio < 1:
        print(
            "Possible liquidity prooblems (considering most liquid assets, i.e. assests without inventory) regarding short-term obligations. Please note that low current ratio is normal in retail sector. ")
    elif acid_ratio == 1 or acid_ratio > 1:
        print("Normal liquiduty")

        # debt ratios
    debt_equity = (cur_L + long_L) / equ

    print('Debt to equity ratio: ', debt_equity)
    if debt_ratio > 2:
        print(
            "High borrowing level. Please note that in capital intensive industries high debt to equity ratio is normal")
    elif debt_ratio < 2:
        print("Normal borrowing level")

        # profitability
    print('Gross margin: ', round(gross_profit, 2), '%')

    print('Operating margin ratio: ', round(op_marg_ratio, 2), "%")

#if choice == 2: # findata from excel. (on progress)
    root = tk.Tk()
    canvas1 = tk.Canvas(root)
    canvas1.pack()
    def getfile():
        global df
        file = filedialog.askopenfilename()
        df = pd.read_excel(file)
        print(df)


    browseButton_Excel = tk.Button(text='Import Excel File', command=getfile)
    canvas1.create_window(150, 150, window=browseButton_Excel)

    root.mainloop()

#if choice == 3: # findata from web. Webscrapping (beautifulSoup): finance.yahoo, bloomberg (on progress) 

